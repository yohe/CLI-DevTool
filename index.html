<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>CLI-DevTool wiki</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <!--
    <link href="css/docs.css" rel="stylesheet">
    -->
    <link href="js/google-code-prettify/prettify.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 20px;
      }

      section {
        padding-top: 30px;
        margin-top: -30px
      }
      h4,h5 {
        padding-top: 40px;
      }
      section > .page-header,
      section > .lead {
        color: #5a5a5a;
      }
      section > ul li {
        margin-bottom: 5px;
      }
  
      /* Separators (hr) */
      .bs-docs-separator {
        margin: 40px 0 39px;
      }

      .sidebar-nav {
        padding: 9px;
      }
      h2,h4,h5 {
        padding-top: -60px
        margin-top: -60px
      }
      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="../assets/ico/favicon.png">

  </head>

  <!-- Scrollspyの設定をbodyタグに記入 -->
  <body>
    <!-- 上部固定のナビゲーションバー -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
        <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="brand" href="#">CLI-DevTool</a>
        <div class="nav-collapse collapse">
          <p class="navbar-text pull-right">
          <a href="https://github.com/yohe/CLI-DevTool">View on GitHub</a>
          <!--<a href="https://github.com/yohe/CLI-DevTool" class="btn btn-primary btn-small">View on GitHub</a> -->
          </p>
          <ul class="nav">
            <li class="active"><a href="./index.html">Home</a></li>
            <li><a href="#">Reference</a></li>
            <li><a href="mailto:ysekiguchi.zzz(at)gmail.com">Contact</a></li>
            <li class="dropdown">
              <a class="dropdown-togle" data-toggle="dropdown" href="#"> language <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="./index.html"><i class="icon-ok"></i> English</strong></a></li>
                <li><a href="./index_jp.html"><i class="icon-minus"></i> Japanese</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-togle" data-toggle="dropdown" href="#"> Download <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="https://github.com/yohe/CLI-DevTool/archive/v1.0.zip"> ver1.0</strong></a></li>
                <li><a href="https://github.com/yohe/CLI-DevTool/zipball/master"> master</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div><!-- /container-fluid -->
      </div><!-- /navbar-inner -->
    </div><!-- /navbar navbar-fixed-top -->


  <div class="container-fluid">
    <div class="row-fluid">
    <div class="span12">
      <div class="hero-unit">
        <h1>CLI-DevTool</h1>
        <hr size=5 color=black>
        <p>This software is development library for developing command-line tool.<br>You can develop a command-line tool with many features by using of this library. For examples, history feature, command completion feature and parameter completion feature.</p>
        <p><a href="https://github.com/yohe/CLI-DevTool/archive/v1.0.zip" class="btn btn-primary btn-large">Download</a></p>
      </div><!-- /hero-unit -->
    </div>
    </div>
    <div class="row-fluid">
      <div class="span3">
        <div class="scroll_filed">
          <div class="bs-docs-sidebar">
          <div>
          <ul class="nav nav-list">
            <li><a href="#getting_started"><strong> Getting Started.</strong></a></li>
            <li><a href="#compile_and_running"><i class="icon-chevron-right"></i> Compiling and execution.</a></li>
            <li><a href="#change_title"><i class="icon-chevron-right"></i> Changing the title.</a></li>
            <li><a href="#change_prompt"><i class="icon-chevron-right"></i> Changing the prompt string.</a></li>
            <li><a href="#regist_command"><i class="icon-chevron-right"></i> Register commands.</a></li>
            <li><a href="#setting_console"><i class="icon-chevron-right"></i> Setting the console.</a></li>
          </ul>
          </div>
          <div>
          <ul class="nav nav-list">
            <li><a href="#defined_new_command"><strong> User-defined command.</strong></a></li>
          </ul>
          </div>
          <div>
          <ul class="nav nav-list">
            <li><a href="#defined_new_action"><strong> User-defined action.</strong></a></li>
            <li><a href="#action_def"><i class="icon-chevron-right"></i> Definition of an action.</a></li>
            <li><a href="#action_setting"><i class="icon-chevron-right"></i> Using of an action.</a></li>
          </ul>
          </div>
          <div>
          <ul class="nav nav-list">
            <li><a href="#required"><strong> Required Packages.</strong></a></li>
          </ul>
          </div>
          </div>
        </div>
      </div><!--/span-->
      <div class="span8">
        <section id="getting_started">
        <h2>Getting Started.</h2>
          <p>
            <ol type="1" style="list-style-position: outside">
              <li><a href="#compile_and_running"> Compiling and execution.</a></li>
              <li><a href="#change_title"> Changing the title.</a></li>
              <li><a href="#change_prompt"> Changing the prompt string.</a></li>
              <li><a href="#regist_command"> Regster commands.</a></li>
              <li><a href="#setting_console"> Setting the console.</a></li>
            </ol>
          </p>
          <p>
          <h4 id="compile_and_running"> Compiling and execution.</h4>
          <p>First, Download form <a href="https://github.com/yohe/CLI-DevTool/zipball/master">here</a>, and let decompress its file, then execute "cmake" and "make" command in the CLI-DevTool directory. If compile occurred error, you check the required libraries.<br>
          <pre>$cmake .
$make</pre>
          </p>
          <p>"console" binary is created by the "make", and you can run sample console by to execute this, then will display as follows when you executed.</p>
          <pre>
+------------------------------------+
|              Console               |
+------------------------------------+
$ </pre>
              <h4 id="change_title"> Changing the title.</h4>
              <p>You can change the title by to chage the "Console::printTitle" function in "sample.cc". This function is called only once at startup. Describe the change in the following example.</p>
              <pre class="prettyprint linenums">
void Console::printTitle() {
    std::cout << "---------------------------------\n";
    std::cout << "   Original Command line tool.\n";
    std::cout << "               Copyright yohe \n";
    std::cout << "---------------------------------\n";
}
</pre>
              <p>In this case, it is displayed the following in the startup.
              <pre>
---------------------------------
   Original Command line tool.
               Copyright yohe 
---------------------------------
$ 
</pre>
              </p>
              <h4 id="change_prompt"> Changing the prompt string.</h4>
              <p>you can change the prompt string by to change the "Console::printPromptImpl()" in "sample.cc". By using the following function that is Defined in the console class, you can express like the prompt of shell.</p>
              <strong>Member function of console class.</strong>
              <ol type="1">
                  <li>getCurrentDirectory()</li>
                  <li>getUserName()</li>
                  <li>getHostName()</li>
              </ol>
              It describe example for changing function as follow.
              <pre class="prettyprint linenums">
std::string Console::printPromptImpl() const {
    std::string dir = getCurrentDirectory();
    //ディレクトリは絶対パスで取得します。下記では、現在のディレクトリ名のみを抽出している。
    std::string prompt = "[" + getUserName() + " " + dir.substr(dir.rfind("/")+1) + "]$ ";
    return prompt;
}</pre>
              <p>In this case, it is displayed the following.</p>
              <pre>[yohe CLI-DevTool]$</pre>
              <h4 id="regist_command"> Register commands.</h4>
              <p> A explain how to register commands to console.
              Registrable commands to console need to inherit the command-class.
User-defined commands refer to here(<a href="#defined_new_command">User-defined command.)</a>. Library is providing some class that is inheriting the command class. They lists at below, and then, it describe example how to register.</p>

              <p class="text-center"><strong>Providing command-class</strong></p>
              <table class="table table-bordered table-striped">
                <colgroup>
                  <col class="span1">
                  <col class="span7">
                </colgroup>
                <thead>
                  <tr>
                    <th>Class</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Command</td>
                    <td>This class is base class for a command. All of command have to inherit this.</td>
                  </tr>
                  <tr>
                    <td>SystemFuncCommand</td>
                    <td>This class provide execution feature by the system function. By to register each command, you can to use it like a shell environment. And completion behavior of the parameters is configurable, so you can use a original behavior that you created.</td>
                  </tr>
                  <tr>
                    <td>ShellCommandExecutor</td>
                    <td>This class provide feature to execute all of the shell commands that can execute on shell. You can to execute command by specify shell command and parameter as "exe" command argument. This class can not configure completion behavior, and can use command name completion and file name completion only.</td>
                  </tr>
                  <tr>
                    <td>EditorCommand</td>
                    <td>This class is used to command for to invoke a editor. This class avoid the problem occur by invoking a editor on while running the built-in script command for logging the operation.</td>
                  </tr>
                </tbody>
              </table>
              <p>Describe at below about the registering a command by using the "SystemFuncCommad" class.</p>
                <pre class="prettyprint linenums">
int main(int argc, char const* argv[])
{
    int historySize = 100;
    bool ctrl_c = true; // false : ignore <CTRL-C> key.
    std::string historyFileName = ".cli_history";

    Console console(historySize, ctrl_c, historyFileName.c_str());

    // SystemFuncCommand(std::string commandName,
    //                   std::string commandOption,
    //                   ParameterBehavior* p,
    //                   HelpBehavior* h)
    if(console.installCommand(new SystemFuncCommand("ls", "-G", new FileListBehavior(), new ManBehavior("ls"))) == false) {
        std::cout &lt&lt "install false" &rt&rt std::endl;
        return -1;
    }

    console.run();
}
</pre>
              <p>Command registration process is 13 to 17 lines, and by the "Console::installCommand" function. If it fails the command registration, it is registered a same name command already. Describe the "SystemFuncCommand" constructor. Detail refer to the <a href="./class_ref.html">class reference</a>.
              </p>
              <table class="table table-bordered table-striped">
                <colgroup>
                  <col class="span1">
                  <col class="span7">
                </colgroup>
                <thead>
                  <tr>
                    <th>Arguments</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>First</td>
                    <td>This argument use as a command name。You need to specify the useable command in a shell.</td>
                  </tr>
                  <tr>
                    <td>Second</td>
                    <td>This argument use as a command option. This option is always enabled.</td>
                  </tr>
                  <tr>
                    <td>Third</td>
                    <td>It specify a completion behavior class in order to generate the command parameter candidates. Parameter completion of a command is executed by return value from the specified class by this argument. FileListBehavior-class of the example as described above be provided by this library. This calss provide a feature that returns a list of files in the current directory.</td>
                  </tr>
                  <tr>
                    <td>Fourth</td>
                    <td>It specify the class to use for displaying help message when invoke the help command with specifying the command name(first argument). ManBehavior-class of the example as described above be provided by this library. This class provides a feature that call the man command.</td>
                  </tr>
                </tbody>
              </table>
              <h4 id="setting_console">Setting the console.</h4>
              <p>This section describe the contents of the following.</p>
              <ol type="1" style="list-style-position: outside">
                <li><a href="#setting_console_history">Setting the history.</a></li>
                <li><a href="#setting_console_keybind">Setting the key bind.</a></li>
                <li><a href="#setting_console_keycode">Changing the key code.</a></li>
              </ol>
              <h5 id="setting_console_history">Setting the history.</h5>
              <p>At below, describe about the history feature. History feature provides the managiment a command execution history by the file, and provides the rerun a command from history. History feature use the "history" command in built-in command. It set the size and filename for the saving a command history. Describing the example at below.</p>
              <pre class="prettyprint linenums">
int main(int argc, char const* argv[])
{
    int historySize = 100;
    std::string historyFileName = "~/.cli_history";
    Console console(historySize, historyFileName.c_str());
    ...
}
              </pre>
              <p>It specify the size and filename as arguments to the constructor of the console class.</p>
              <h5 id="setting_console_keybind">Setting the key bind.</h5>
              <p>This section describe the setting of the key binding for the console. This library can to set the action to the combination-key or the function-key. Actions describe at below.</p>
              <table class="table table-bordered table-striped">
                <colgroup>
                  <col class="span1">
                  <col class="span7">
                </colgroup>
                <thead>
                  <tr>
                    <th>Action</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>actionDeleteBackwardCharacter</td>
                    <td>This action deletes a character at the before a cursor, and move to left the cursor. This action is the same behavior as the backspace key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionDeleteForwardCharacter</td>
                    <td>This action deletes a character on the cursor. This action is the same behavior as the delete key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionDeleteFromCursorToEnd</td>
                    <td>This action deletes characters from the cursor position to the end of line. This action is same behavior as CTRL+K key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionDeleteFromHeadToCursor</td>
                    <td>This action deletes characters from the beginning of line to the cursor position. This action is same behavior as CTRL+U key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionDeleteParam</td>
                    <td>This action deletes characters from the cursor position to the top of next parameter position.</td>
                  </tr>
                  <tr>
                    <td>actionMoveCursorRight</td>
                    <td>This action moves the cursor to right one character.</td>
                  </tr>
                  <tr>
                    <td>actionMoveCursorLeft</td>
                    <td>This action moves the cursor to left one character.</td>
                  </tr>
                  <tr>
                    <td>actionMoveCursorForwardParam</td>
                    <td>This action moves the cursor to the next parameter position.</td>
                  </tr>
                  <tr>
                    <td>actionMoveCursorBackwardParam</td>
                    <td>This action moves the cursor to the top of before parameter position.</td>
                  </tr>
                  <tr>
                    <td>actionMoveCursorTop</td>
                    <td>This action moves the cursor to the beginning of line. This action is same behavior as CTRL+A key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionMoveCursorBottom</td>
                    <td>This action moves the cursor to the end of line. This action is same behavior as CTRL+E key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionBackwardHistory</td>
                    <td>This action go back a command history.</td>
                  </tr>
                  <tr>
                    <td>actionForwardHistory</td>
                    <td>This action go forward a command history.</td>
                  </tr>
                  <tr>
                    <td>actionExecute</td>
                    <td>This action execute command that was inputting in console. This action is same behavior as ENTER key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionComplete</td>
                    <td>This action execute the completion feature. This action is same behavior as TAB key on the terminal.</td>
                  </tr>
                  <tr>
                    <td>actionTerminate</td>
                    <td>Exit the console.</td>
                  </tr>
                  <tr>
                    <td>actionClearLine</td>
                    <td>This action clear the inputted string.</td>
                  </tr>
                  <tr>
                    <td>actionClearScreen</td>
                    <td>Clear the console. This action is same behavior as CTRL+L key on the terminal.</td>
                  </tr>
                </tbody>
              </table>
              <p>
You need to know when set the key bindings that two or more different key has a same keycode. These all keys are set a key binding all together when set a key binding to a one of these key. You can check the key code by the "key_trace" that is created by the compilation.<br>
It describe about the setting of key bindings. The setting of key bindings write by using the "Console::registerKeyBinding" in the function of the "Console::keyBindInitialize". The "Console::registerKeyBinding" specify two parameters that parameters are key and action.<br>
In the below example, it setting a behavior of the BS key and DEL key.
              </p>
              <pre class="prettyprint linenums">
void Console::keyBindInitialize() {
    // BS キー登録
    registerKeyBinding(KeyCode::KEY_BS, &Console::actionDeleteBackwardCharacter);
    // DELETE キー登録
    registerKeyBinding(KeyCode::KEY_DEL, &Console::actionDeleteForwardCharacter);
}
              </pre>
              <br>
              <h5 id="setting_console_keycode">キーコード変更</h5>
              <p>There is a case that is expressed a same code sequence by different keys. In this case, Console can not accurate detection of a input key by the default key-code setting, so you need to change the key-code setting. You can check the key-code sequence corresponding to a input key by the key_trace. The key_trace being created by the compile.<br>
              The key-code is defined in the "key_code.h" file.
              </p>
              <br>
              </section>
              <section id="defined_new_command">
                  <h2>User-defined command.</h2>
                  <div class="alert alert-info">
                      <strong> Info </strong>"I have been writing this section now, so please wait a moment."
                  </div>
              </section>
              <section id="defined_new_action">
                  <h2>User-defined action.</h2>
                  <p>
                    <ol type="1" style="list-style-position: outside">
                      <li><a href="#action_def"> Definition of an action.</a></li>
                      <li><a href="#action_setting"> Using of an action.</a></li>
                    </ol>
                  </p>
                  <h5 id="action_def"> Definition of an action.</h5>
                  <p>User-defined action can implement freely by users, and this action can use to the setting of the key bindings. ユーザ定義アクションを使用することで、コマンドラインに規定の文字列を入力させるような動作も実現可能になります。ユーザ定義アクションは、"UserAction"クラスを継承して定義します。コマンドラインに "exe "を入力させる実装例を以下に示す。
                  </p>
                  <pre class="prettyprint linenums">
class InsertExeAction : public UserAction {
public:
    InsertExeAction() {}
    virtual ~InsertExeAction() {}

    virtual void operator()() {
        Console* console = get();
        console->actionClearLine();
        console->insertStringToTerminal("exe ");
    }
};
                  </pre>
                  <h5 id="action_setting"> Using of an action.</h5>
                  <p>作成したアクションのキーバインド設定について記載する。設定方法は<a href="#setting_console_keybind">キーバインド設定</a>で記載した方法と同じです。以下に作成したアクションをキーバインドで設定する例を示す。
                  </p>
                  <pre class="prettyprint linenums">
void Console::keyBindInitialize() {
    // BS キー登録
    registerKeyBinding(KeyCode::KEY_BS, &Console::actionDeleteBackwardCharacter);
    // DELETE キー登録
    registerKeyBinding(KeyCode::KEY_DEL, &Console::actionDeleteForwardCharacter);

    //CTRL-W 登録
    InsertExeAction* insertExeAction = new InsertExeAction();
    registerKeyBinding(KeyCode::KEY_CTRL_W, insertExeAction);
}
                  </pre>
              </section>
              <section id="required">
                  <h2>Required packages.</h2>
                  <ul>
                      <li>cmake 2.6 or later</li>
                      <li>make</li>
                      <li>c++ compiler</li>
                      <li>ncurses-dev</li>
                  </ul>
              </section>
              <br>
              <br>
          </div><!-- /span8 -->

  </div><!-- /row -->

  <hr>

  <footer>
  <p>&copy; Yohei Sekiguchi <a href="mailto:ysekiguchi.zzz at gmail.com">&ltysekiguchi.zzz at gmail.com&gt</a> you have to change to "@" from "at".</p>
  </footer>

      </div><!-- /container -->

      <script src="js/bootstrap.js"></script>
      <script src="js/bootstrap.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
      <script src="js/google-code-prettify/prettify.js"></script>
      <script>prettyPrint();</script>
      <script src="js/bootstrap.min.js"></script>

  </body>

  </html>
